(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{IhWD:function(t,e,n){"use strict";n.r(e),n.d(e,"TenantModule",(function(){return kt}));var i=n("Tx//"),c=n("tyNb"),a=n("P+IX"),o=n("uswQ"),r=n("fXoL"),s=n("UDmo"),d=n("bTqV"),l=n("NFeN");let u=(()=>{class t{constructor(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=r.Bc({type:t,selectors:[["app-tenant-list-toolbar"]],decls:5,vars:1,consts:[[1,"app-page-toolbar"],["mat-raised-button","","color","primary",3,"routerLink"],["fontSet","fas","fontIcon","fa-plus","inline",""],["key","common.new"]],template:function(t,e){1&t&&(r.Nc(0,"div",0),r.Nc(1,"button",1),r.Ic(2,"mat-icon",2),r.yd(3,"\xa0 "),r.Ic(4,"app-i18n",3),r.Mc(),r.Mc()),2&t&&(r.wc(1),r.dd("routerLink","/tenant/new"))},directives:[d.b,c.c,l.a,s.a],encapsulation:2}),t})();var m=n("mrSG"),f=n("St/f"),p=n("qXBG"),h=n("mmyZ"),v=n("j62l");let g=(()=>{class t{constructor(t){this.authService=t}get hasPermissionToRead(){return!0}hasPermissionToDestroy(t){return new v.a(t,this.authService.currentUser).match(h.a.values.tenantDestroy)}hasPermissionToEdit(t){return new v.a(t,this.authService.currentUser).match(h.a.values.tenantEdit)}get hasPermissionToCreate(){return!0}}return t.\u0275fac=function(e){return new(e||t)(r.Rc(p.a))},t.\u0275prov=r.Dc({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var b=n("AKtp"),y=n("t7ZL"),w=n("zkTT"),I=n("QmLB"),S=n("ZSv9"),N=n("Vbab");let k=(()=>{class t{constructor(t,e,n,i,c){this.errorService=t,this.snackbar=e,this.router=n,this.tenantListService=i,this.authService=c,this.loading=!1}doDestroy(t){return Object(m.a)(this,void 0,void 0,(function*(){try{this.loading=!0,yield S.a.destroyAll([t]),this.loading=!1,this.snackbar.success(Object(N.d)("tenant.destroy.success")),yield this.tenantListService.doFetch(this.tenantListService.filter),yield this.authService.doRefreshCurrentUser();const e=new v.a(this.authService.currentTenant,this.authService.currentUser);this.router.navigate(e.isEmptyTenant?["/auth/tenant"]:["/tenant"])}catch(e){this.errorService.handle(e),this.loading=!1}}))}doDestroyAll(t){return Object(m.a)(this,void 0,void 0,(function*(){try{this.loading=!0,yield S.a.destroyAll(t),this.loading=!1,this.tenantListService.doResetSelectedKeys(),this.snackbar.success(Object(N.d)("tenant.destroyAll.success")),yield this.tenantListService.doFetch(this.tenantListService.filter),yield this.authService.doRefreshCurrentUser();const e=new v.a(this.authService.currentTenant,this.authService.currentUser);this.router.navigate(e.isEmptyTenant?["/auth/tenant"]:["/tenant"])}catch(e){this.errorService.handle(e),this.loading=!1}}))}}return t.\u0275fac=function(e){return new(e||t)(r.Rc(I.a),r.Rc(w.a),r.Rc(c.b),r.Rc(f.a),r.Rc(p.a))},t.\u0275prov=r.Dc({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var T=n("ER6R"),M=n("a/xz"),L=n("AytR"),x=n("fmGZ"),D=n("+0xr"),X=n("Dh3D"),C=n("ofXK"),O=n("M9IT"),E=n("A5z7"),A=n("Qu3c");function R(t,e){if(1&t&&(r.Nc(0,"th",12),r.yd(1),r.Mc()),2&t){const t=r.Xc();r.wc(1),r.Ad(" ",t.fields.name.label," ")}}function P(t,e){1&t&&(r.Nc(0,"mat-chip",15),r.Ic(1,"app-i18n",16),r.Mc())}function j(t,e){if(1&t&&(r.Nc(0,"td",13),r.yd(1),r.xd(2,P,2,0,"mat-chip",14),r.Mc()),2&t){const t=e.$implicit,n=r.Xc();r.wc(1),r.Ad(" ",n.presenter(t,"name")," "),r.wc(1),r.dd("ngIf",n.invitationToken(t))}}function U(t,e){if(1&t&&(r.Nc(0,"th",12),r.yd(1),r.Mc()),2&t){const t=r.Xc();r.wc(1),r.Ad(" ",t.fields.url.label," ")}}function H(t,e){if(1&t&&(r.Nc(0,"td",13),r.yd(1),r.Mc()),2&t){const t=e.$implicit,n=r.Xc();r.wc(1),r.Ad(" ",n.urlOf(t)," ")}}function F(t,e){if(1&t&&(r.Nc(0,"th",12),r.yd(1),r.Mc()),2&t){const t=r.Xc();r.wc(1),r.Ad(" ",t.fields.plan.label," ")}}function $(t,e){if(1&t&&(r.Nc(0,"td",13),r.Nc(1,"mat-chip-list"),r.Nc(2,"mat-chip",17),r.yd(3),r.Mc(),r.Mc(),r.Mc()),2&t){const t=e.$implicit,n=r.Xc();r.wc(2),r.dd("color",t.plan===n.plans.free?"gray":"accent"),r.wc(1),r.Ad(" ",n.planLabelOf(t.plan)," ")}}function z(t,e){1&t&&r.Ic(0,"th",18)}function B(t,e){if(1&t){const t=r.Oc();r.Nc(0,"span"),r.Nc(1,"button",21),r.Tc("click",(function(){r.od(t);const e=r.Xc().$implicit,n=r.Xc();return n.doAcceptInvitation(n.invitationToken(e))})),r.Ic(2,"app-i18n",22),r.Mc(),r.Nc(3,"button",23),r.Tc("click",(function(){r.od(t);const e=r.Xc().$implicit,n=r.Xc();return n.doDeclineInvitation(n.invitationToken(e))})),r.Ic(4,"app-i18n",24),r.Mc(),r.Mc()}}function q(t,e){if(1&t){const t=r.Oc();r.Nc(0,"button",21),r.Tc("click",(function(){r.od(t);const e=r.Xc(2).$implicit;return r.Xc().doSelectTenant(e)})),r.Ic(1,"app-i18n",28),r.Mc()}}const G=function(t){return["/tenant",t,"edit"]};function K(t,e){if(1&t&&(r.Nc(0,"button",29),r.Nc(1,"mat-icon"),r.yd(2,"edit"),r.Mc(),r.Mc()),2&t){const t=r.Xc(2).$implicit,e=r.Xc();r.dd("routerLink",r.hd(2,G,t.id))("matTooltip",e.i18n("common.edit"))}}function Z(t,e){if(1&t){const t=r.Oc();r.Nc(0,"button",30),r.Tc("click",(function(){r.od(t);const e=r.Xc(2).$implicit;return r.Xc().doDestroy(e.id)})),r.Nc(1,"mat-icon"),r.yd(2,"delete"),r.Mc(),r.Mc()}if(2&t){const t=r.Xc(3);r.dd("matTooltip",t.i18n("common.destroy"))}}function J(t,e){if(1&t&&(r.Nc(0,"span"),r.xd(1,q,2,0,"button",25),r.xd(2,K,3,4,"button",26),r.xd(3,Z,3,1,"button",27),r.Mc()),2&t){const t=r.Xc().$implicit,e=r.Xc();r.wc(1),r.dd("ngIf",!e.isCurrentTenant(t)),r.wc(1),r.dd("ngIf",e.hasPermissionToEdit(t)),r.wc(1),r.dd("ngIf",e.hasPermissionToDestroy(t))}}function Q(t,e){if(1&t&&(r.Nc(0,"td",19),r.xd(1,B,5,0,"span",20),r.xd(2,J,4,3,"span",20),r.Mc()),2&t){const t=e.$implicit,n=r.Xc();r.wc(1),r.dd("ngIf",n.invitationToken(t)),r.wc(1),r.dd("ngIf",!n.invitationToken(t))}}function Y(t,e){1&t&&r.Ic(0,"tr",31)}function V(t,e){1&t&&r.Ic(0,"tr",32)}function W(t,e){1&t&&(r.Nc(0,"div",33),r.Ic(1,"app-i18n",34),r.Mc())}function _(t,e){1&t&&(r.Nc(0,"div",33),r.Ic(1,"app-i18n",35),r.Mc())}const tt=function(){return[10,20,30,40]};let et=(()=>{class t{constructor(t,e,n,i,c,a){this.service=t,this.authService=e,this.destroyService=n,this.tenantService=i,this.tenantInvitationService=c,this.confirmService=a}ngOnInit(){return this.service.doFetch()}presenter(t,e){return b.a.presenter(t,e)}i18n(t){return Object(N.d)(t)}get tenantSubdomain(){return x.a}doSelectTenant(t){return this.authService.doSelectTenant(t)}urlOf(t){return`${t.url}.${L.a.frontendUrl.host}`}doAcceptInvitation(t){return Object(m.a)(this,void 0,void 0,(function*(){if(yield this.confirmService.confirm())return this.tenantInvitationService.doAccept(t)}))}doDeclineInvitation(t){return Object(m.a)(this,void 0,void 0,(function*(){if(yield this.confirmService.confirm())return this.tenantInvitationService.doDecline(t)}))}doDestroy(t){return Object(m.a)(this,void 0,void 0,(function*(){if(yield this.confirmService.confirm())return this.destroyService.doDestroy(t)}))}get invitationLoading(){return this.tenantInvitationService.loading}invitationToken(t){return this.tenantInvitationService.invitationToken(t)}hasPermissionToEdit(t){return this.tenantService.hasPermissionToEdit(t)}hasPermissionToDestroy(t){return this.tenantService.hasPermissionToDestroy(t)}get fields(){return b.a.fields}get columns(){return[this.fields.name.name,x.a.isEnabled&&this.fields.url.name,L.a.isPlanEnabled&&this.fields.plan.name,"_actions"].filter(Boolean)}get plans(){return M.a.values}planLabelOf(t){return Object(N.d)(`plan.${t}.label`)}isCurrentTenant(t){return this.authService.currentTenant.id===t.id}}return t.\u0275fac=function(e){return new(e||t)(r.Hc(f.a),r.Hc(p.a),r.Hc(k),r.Hc(g),r.Hc(T.a),r.Hc(y.a))},t.\u0275cmp=r.Bc({type:t,selectors:[["app-tenant-list-table"]],decls:19,vars:16,consts:[[1,"table-responsive"],["mat-table","","matSort","",2,"width","100%",3,"dataSource","matSortActive","matSortDirection","matSortChange"],[3,"matColumnDef"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","_actions"],["mat-header-cell","",4,"matHeaderCellDef"],["style","width: 180px; text-align: right;","mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-table-message",4,"ngIf"],["showFirstLastButtons","",3,"disabled","pageIndex","pageSize","pageSizeOptions","length","page"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["color","accent","selected","","style","margin-left: 8px;",4,"ngIf"],["color","accent","selected","",2,"margin-left","8px"],["key","tenant.invitation.invited"],["selected","",3,"color"],["mat-header-cell",""],["mat-cell","",2,"width","180px","text-align","right"],[4,"ngIf"],["mat-raised-button","","color","primary","type","button",2,"margin-right","8px",3,"click"],["key","tenant.invitation.accept"],["mat-raised-button","","color","warn","type","button",3,"click"],["key","tenant.invitation.decline"],["mat-raised-button","","color","primary","type","button","style","margin-right: 8px;",3,"click",4,"ngIf"],["mat-icon-button","","type","button","color","primary",3,"routerLink","matTooltip",4,"ngIf"],["mat-icon-button","","type","button","color","primary",3,"matTooltip","click",4,"ngIf"],["key","tenant.select"],["mat-icon-button","","type","button","color","primary",3,"routerLink","matTooltip"],["mat-icon-button","","type","button","color","primary",3,"matTooltip","click"],["mat-header-row",""],["mat-row",""],[1,"mat-table-message"],["key","table.noData"],["key","table.loading"]],template:function(t,e){1&t&&(r.Nc(0,"div",0),r.Nc(1,"table",1),r.Tc("matSortChange",(function(t){return e.service.doChangeSort(t)})),r.Lc(2,2),r.xd(3,R,2,1,"th",3),r.xd(4,j,3,2,"td",4),r.Kc(),r.Lc(5,2),r.xd(6,U,2,1,"th",3),r.xd(7,H,2,1,"td",4),r.Kc(),r.Lc(8,2),r.xd(9,F,2,1,"th",3),r.xd(10,$,4,2,"td",4),r.Kc(),r.Lc(11,5),r.xd(12,z,1,0,"th",6),r.xd(13,Q,3,2,"td",7),r.Kc(),r.xd(14,Y,1,0,"tr",8),r.xd(15,V,1,0,"tr",9),r.Mc(),r.xd(16,W,2,0,"div",10),r.xd(17,_,2,0,"div",10),r.Mc(),r.Nc(18,"mat-paginator",11),r.Tc("page",(function(t){return e.service.doChangePagination(t)})),r.Mc()),2&t&&(r.wc(1),r.dd("dataSource",e.service.rows)("matSortActive",e.service.sorter.columnKey)("matSortDirection",e.service.sorter.order),r.wc(1),r.dd("matColumnDef",e.fields.name.name),r.wc(3),r.dd("matColumnDef",e.fields.url.name),r.wc(3),r.dd("matColumnDef",e.fields.plan.name),r.wc(6),r.dd("matHeaderRowDef",e.columns),r.wc(1),r.dd("matRowDefColumns",e.columns),r.wc(1),r.dd("ngIf",!e.service.loading&&!e.service.count),r.wc(1),r.dd("ngIf",e.service.loading),r.wc(1),r.dd("disabled",e.service.loading)("pageIndex",e.service.paginationPageIndex)("pageSize",e.service.paginationPageSize)("pageSizeOptions",r.gd(15,tt))("length",e.service.count))},directives:[D.j,X.a,D.c,D.e,D.b,D.g,D.i,C.k,O.a,D.d,X.b,D.a,E.a,s.a,E.c,d.b,c.c,A.a,l.a,D.f,D.h],encapsulation:2}),t})(),nt=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=r.Bc({type:t,selectors:[["app-tenant-list"]],decls:5,vars:0,consts:[[1,"app-content-page"],[1,"app-content-title"],["key","tenant.list.title"]],template:function(t,e){1&t&&(r.Nc(0,"div",0),r.Nc(1,"h1",1),r.Ic(2,"app-i18n",2),r.Mc(),r.Ic(3,"app-tenant-list-toolbar"),r.Ic(4,"app-tenant-list-table"),r.Mc())},directives:[s.a,u,et],encapsulation:2}),t})();var it=n("YHaZ"),ct=n("APW9"),at=n("Xa2L"),ot=n("rXYk"),rt=n("3Pt+"),st=n("kmnG"),dt=n("qFsG"),lt=n("YPZE"),ut=n("vFJ8");function mt(t,e){if(1&t&&(r.Nc(0,"mat-form-field",3),r.Nc(1,"mat-label"),r.yd(2),r.Mc(),r.Ic(3,"input",17),r.Nc(4,"span",18),r.yd(5),r.Mc(),r.Nc(6,"mat-error"),r.Ic(7,"app-validations",5),r.Mc(),r.Mc()),2&t){const t=r.Xc(2);r.wc(2),r.zd(t.fields.tenantUrl.label),r.wc(1),r.dd("formControlName",t.fields.tenantUrl.name)("required",t.fields.tenantUrl.required),r.wc(2),r.zd(t.frontendUrlHost),r.wc(2),r.dd("control",t.form.get(t.fields.tenantUrl.name))("label",t.fields.tenantUrl.label)}}function ft(t,e){if(1&t){const t=r.Oc();r.Nc(0,"form",1,2),r.Tc("ngSubmit",(function(){return r.od(t),r.Xc().doSave()})),r.Nc(2,"mat-form-field",3),r.Nc(3,"mat-label"),r.yd(4),r.Mc(),r.Ic(5,"input",4),r.Nc(6,"mat-error"),r.Ic(7,"app-validations",5),r.Mc(),r.Mc(),r.xd(8,mt,8,6,"mat-form-field",6),r.Nc(9,"div",7),r.Nc(10,"button",8),r.Ic(11,"mat-icon",9),r.yd(12,"\xa0 "),r.Ic(13,"app-i18n",10),r.Mc(),r.Nc(14,"button",11),r.Tc("click",(function(){return r.od(t),r.Xc().doReset()})),r.Ic(15,"mat-icon",12),r.yd(16,"\xa0 "),r.Ic(17,"app-i18n",13),r.Mc(),r.Nc(18,"button",14),r.Tc("click",(function(){return r.od(t),r.Xc().cancel.emit()})),r.Ic(19,"mat-icon",15),r.yd(20,"\xa0 "),r.Ic(21,"app-i18n",16),r.Mc(),r.Mc(),r.Mc()}if(2&t){const t=r.Xc();r.dd("formGroup",t.form),r.wc(4),r.zd(t.fields.tenantName.label),r.wc(1),r.dd("formControlName",t.fields.tenantName.name)("required",t.fields.tenantName.required),r.wc(2),r.dd("control",t.form.get(t.fields.tenantName.name))("label",t.fields.tenantName.label),r.wc(1),r.dd("ngIf",t.tenantSubdomain.isEnabled),r.wc(1),r.zc("form-buttons-modal",t.modal),r.wc(1),r.dd("disabled",t.saveLoading),r.wc(4),r.dd("disabled",t.saveLoading),r.wc(4),r.dd("disabled",t.saveLoading)}}let pt=(()=>{class t{constructor(t){this.formBuilder=t,this.save=new r.v,this.cancel=new r.v,this.modal=!1}ngOnInit(){return Object(m.a)(this,void 0,void 0,(function*(){this.buildSchema(),this.buildForm()}))}get fields(){return b.a.fields}doSave(){if(!this.form.valid)return;const t=this.record&&this.record.id,e=this.schema.cast(this.form.value);this.save.emit({id:t,values:e})}doReset(){this.buildForm()}buildForm(){this.form=this.schema.buildForm(this.record)}get frontendUrlHost(){return"."+L.a.frontendUrl.host}get tenantSubdomain(){return x.a}buildSchema(){this.schema=new ot.a([this.fields.tenantName,x.a.isEnabled&&this.fields.tenantUrl].filter(Boolean),this.formBuilder)}}return t.\u0275fac=function(e){return new(e||t)(r.Hc(rt.d))},t.\u0275cmp=r.Bc({type:t,selectors:[["app-tenant-form"]],inputs:{isEditing:"isEditing",record:"record",saveLoading:"saveLoading",modal:"modal"},outputs:{save:"save",cancel:"cancel"},decls:1,vars:1,consts:[["class","form",3,"formGroup","ngSubmit",4,"ngIf"],[1,"form",3,"formGroup","ngSubmit"],["ngForm","ngForm"],["floatLabel","always","appearance","outline"],["matInput","","appAutofocus","",3,"formControlName","required"],[3,"control","label"],["floatLabel","always","appearance","outline",4,"ngIf"],[1,"form-buttons"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["inline","","fontSet","far","fontIcon","fa-save"],["key","common.save"],["mat-flat-button","","color","accent","type","button",3,"disabled","click"],["inline","","fontSet","fas","fontIcon","fa-undo"],["key","common.reset"],["mat-flat-button","","color","warn","type","button",3,"disabled","click"],["inline","","fontSet","fas","fontIcon","fa-times"],["key","common.cancel"],["matInput","",3,"formControlName","required"],["matSuffix",""]],template:function(t,e){1&t&&r.xd(0,ft,22,12,"form",0),2&t&&r.dd("ngIf",e.form)},directives:[C.k,rt.s,rt.n,rt.h,st.c,st.f,dt.b,rt.c,lt.a,rt.m,rt.g,rt.q,st.b,ut.a,d.b,l.a,s.a,st.h],encapsulation:2}),t})();function ht(t,e){1&t&&r.Ic(0,"app-i18n",7)}function vt(t,e){1&t&&r.Ic(0,"app-i18n",8)}function gt(t,e){1&t&&(r.Nc(0,"div",9),r.Ic(1,"mat-spinner",10),r.Mc())}function bt(t,e){if(1&t){const t=r.Oc();r.Nc(0,"app-tenant-form",11),r.Tc("save",(function(e){return r.od(t),r.Xc().doSave(e)}))("cancel",(function(){return r.od(t),r.Xc().doCancel()})),r.Mc()}if(2&t){const t=r.Xc();r.dd("saveLoading",t.saveLoading)("record",t.record)("isEditing",t.isEditing)("modal",!1)}}let yt=(()=>{class t{constructor(t,e,n){this.service=t,this.route=e,this.router=n,this.breadcrumb=[[Object(N.d)("tenant.menu"),"/tenant"],[this.isEditing?Object(N.d)("tenant.edit.title"):Object(N.d)("tenant.new.title")]]}ngOnInit(){return Object(m.a)(this,void 0,void 0,(function*(){yield this.service.doInit(this.route.snapshot.paramMap.get("id"))}))}get isEditing(){return this.route.snapshot.paramMap.has("id")}get initLoading(){return this.service.initLoading}get saveLoading(){return this.service.saveLoading}get record(){return this.service.record}doSave(t){return this.isEditing?this.service.doUpdate(t.id,t.values):this.service.doCreate(t.values)}doCancel(){this.router.navigate(["/tenant"])}}return t.\u0275fac=function(e){return new(e||t)(r.Hc(it.a),r.Hc(c.a),r.Hc(c.b))},t.\u0275cmp=r.Bc({type:t,selectors:[["app-tenant-form-page"]],decls:7,vars:5,consts:[[3,"items"],[1,"app-content-page"],[1,"app-content-title"],["key","tenant.edit.title",4,"ngIf"],["key","tenant.new.title",4,"ngIf"],["class","app-page-spinner",4,"ngIf"],[3,"saveLoading","record","isEditing","modal","save","cancel",4,"ngIf"],["key","tenant.edit.title"],["key","tenant.new.title"],[1,"app-page-spinner"],["color","accent"],[3,"saveLoading","record","isEditing","modal","save","cancel"]],template:function(t,e){1&t&&(r.Ic(0,"app-breadcrumb",0),r.Nc(1,"div",1),r.Nc(2,"h1",2),r.xd(3,ht,1,0,"app-i18n",3),r.xd(4,vt,1,0,"app-i18n",4),r.Mc(),r.xd(5,gt,2,0,"div",5),r.xd(6,bt,1,4,"app-tenant-form",6),r.Mc()),2&t&&(r.dd("items",e.breadcrumb),r.wc(3),r.dd("ngIf",e.isEditing),r.wc(1),r.dd("ngIf",!e.isEditing),r.wc(1),r.dd("ngIf",e.initLoading),r.wc(1),r.dd("ngIf",!e.initLoading))},directives:[ct.a,C.k,s.a,at.b,pt],encapsulation:2}),t})();const wt=[{path:"",component:o.a,children:[{path:":id/edit",component:yt,canActivate:[a.a]},{path:"new",component:yt,canActivate:[a.a]},{path:"",component:nt,canActivate:[a.a]}]}];let It=(()=>{class t{}return t.\u0275mod=r.Fc({type:t}),t.\u0275inj=r.Ec({factory:function(e){return new(e||t)},providers:[],imports:[[c.f.forChild(wt)],c.f]}),t})();var St=n("PCNd"),Nt=n("t9Rf");let kt=(()=>{class t{}return t.\u0275mod=r.Fc({type:t}),t.\u0275inj=r.Ec({factory:function(e){return new(e||t)},imports:[[St.a,It,i.a,Nt.a]]}),t})()}}]);